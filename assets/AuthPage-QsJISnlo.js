import{j as e,s as y,t as v,e as N,z as q,P as F}from"./index-DxOACovA.js";import{b as a,f as P,L as f,h as A}from"./vendor-Bj2_SvGi.js";import{e as L,f as R,u as U,h as W}from"./firebase-CWRDQEVH.js";function D(){const[s,g]=a.useState(""),[n,i]=a.useState(""),[t,u]=a.useState(""),[l,x]=a.useState(!1),p=P(),o={"auth/invalid-email":"Please enter a valid email.","auth/user-disabled":"This account has been disabled. Contact support.","auth/user-not-found":"No account found with this email.","auth/wrong-password":"Incorrect password. Please try again.","auth/missing-password":"Password is required.","auth/too-many-requests":"Too many failed attempts. Please try again later.","auth/invalid-credential":"Invalid email or password. Please try again."},c=async d=>{d.preventDefault(),u("");try{const h=(await L(N,s,n)).user;localStorage.setItem("user",JSON.stringify({uid:h.uid,email:h.email,displayName:h.displayName||""})),console.log(s,n),p("/"),window.location.reload()}catch(m){const h=o[m.code]||"Login failed. Please try again.";console.log("Firebase Error Code:",m.code),u(h)}};return e.jsxs("div",{className:"p-4 border rounded w-100",style:{maxWidth:"400px"},children:[e.jsx("h2",{className:"title text-center mb-4",children:"Sign In"}),e.jsxs("form",{onSubmit:c,className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"title form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:s,onChange:d=>g(d.target.value),required:!0})]}),e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{className:"title form-label",children:"Password"}),e.jsx("input",{type:l?"text":"password",className:"form-control",value:n,onChange:d=>i(d.target.value),required:!0}),e.jsx("span",{className:"eye-icon position-absolute end-0 me-3 text-secondary",style:{cursor:"pointer"},onClick:()=>x(!l),children:l?e.jsx(y,{}):e.jsx(v,{})})]}),t&&e.jsx("div",{className:"alert alert-danger",children:t}),e.jsx("button",{type:"submit",className:"my-btn my-btn-primary w-100",children:"Sign In"}),e.jsxs("p",{className:"mt-3 text-center link-txt",children:["Donâ€™t have an account? ",e.jsx(f,{to:"/auth/sign-up",children:"Sign Up"})]}),e.jsx("p",{className:"mt-2 text-center link-txt",children:e.jsx(f,{to:"/auth/forgot-password",children:"Forgot your password?"})})]})]})}function T(){const[s,g]=a.useState(""),[n,i]=a.useState(""),[t,u]=a.useState(""),[l,x]=a.useState(""),[p,o]=a.useState(""),[c,d]=a.useState(""),[m,h]=a.useState(!1),[w,S]=a.useState(!1),C=P(),E=()=>s.trim()?n.includes("@")?t.length<8?"Password must be at least 8 characters.":/[A-Z]/.test(t)?/[a-z]/.test(t)?/[0-9]/.test(t)?t!==l?"Passwords do not match.":null:"Password must include at least one number.":"Password must include at least one lowercase letter.":"Password must include at least one uppercase letter.":"Please enter a valid email.":"Name is required.",k=r=>{switch(r){case"auth/email-already-in-use":return"This email is already registered.";case"auth/invalid-email":return"Please enter a valid email.";case"auth/weak-password":return"Password should be at least 8 characters.";case"auth/operation-not-allowed":return"Email/password accounts are not enabled.";default:return"Something went wrong. Please try again."}},I=async r=>{r.preventDefault(),o(""),d("");const b=E();if(b){o(b);return}try{const j=await R(N,n,t);await U(j.user,{displayName:s}),d("Account created successfully! "),setTimeout(()=>C("/auth/sign-in"),1500)}catch(j){o(k(j.code))}};return e.jsxs("div",{className:"p-4 border rounded w-100",style:{maxWidth:"400px"},children:[e.jsx("h2",{className:"title text-center mb-4",children:"Sign Up"}),e.jsxs("form",{onSubmit:I,className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"title form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:s,onChange:r=>g(r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"title form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:n,onChange:r=>i(r.target.value),required:!0})]}),e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{className:"title form-label",children:"Password"}),e.jsx("input",{type:m?"text":"password",className:"form-control",value:t,onChange:r=>u(r.target.value),required:!0}),e.jsx("span",{className:"eye-icon position-absolute end-0 me-3 text-secondary",onClick:()=>h(!m),children:m?e.jsx(y,{}):e.jsx(v,{})})]}),e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{className:"title form-label",children:"Confirm Password"}),e.jsx("input",{type:w?"text":"password",className:"form-control",value:l,onChange:r=>x(r.target.value),required:!0}),e.jsx("span",{className:"eye-icon position-absolute end-0 me-3 text-secondary",onClick:()=>S(!w),children:w?e.jsx(y,{}):e.jsx(v,{})})]}),p&&e.jsx("div",{className:"alert alert-danger",children:p}),c&&e.jsx("div",{className:"alert alert-success",children:c}),e.jsx("button",{type:"submit",className:"my-btn my-btn-primary w-100",children:"Sign Up"}),e.jsxs("p",{className:"mt-3 text-center link-txt",children:["Already have an account? ",e.jsx(f,{to:"/auth/sign-in",children:"Sign In"})]})]})]})}function z(){const[s,g]=a.useState(""),[n,i]=a.useState(""),[t,u]=a.useState(""),[l,x]=a.useState(!1),p=async o=>{if(o.preventDefault(),i(""),u(""),!s){i("Please enter your email.");return}x(!0);try{await W(N,s),u("Password reset link sent! Check your email.")}catch(c){console.log("Firebase Error Code:",c.code),c.code==="auth/user-not-found"?i("No user found with this email."):c.code==="auth/invalid-email"?i("Invalid email address."):i("Failed to send reset email. Please try again later.")}x(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(SpinnerOverlay,{loading:l}),e.jsxs("div",{className:"p-4 border rounded w-100",style:{maxWidth:"400px",margin:"0 auto"},children:[e.jsx("h2",{className:"title text-center mb-4",children:"Forgot Password"}),e.jsxs("form",{onSubmit:p,className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"title form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:s,onChange:o=>g(o.target.value),required:!0})]}),n&&e.jsx("div",{className:"alert alert-danger",children:n}),t&&e.jsx("div",{className:"alert alert-success",children:t}),e.jsx("button",{type:"submit",className:"my-btn my-btn-primary w-100",disabled:l,children:l?e.jsx(F,{}):q.success("Send Reset Link")}),e.jsxs("p",{className:"mt-3 text-center link-txt",children:["Remembered your password? ",e.jsx(f,{to:"/auth/sign-in",children:"Sign In"})]})]})]})]})}function Z(){const{type:s}=A();return s!=="sign-in"&&s!=="sign-up"&&s!=="forgot-password"?e.jsx(Navigate,{to:"/auth/sign-in",replace:!0}):e.jsxs("div",{className:"container-auth container d-flex justify-content-center align-items-center",children:[s==="sign-in"&&e.jsx(D,{}),s==="sign-up"&&e.jsx(T,{}),s==="forgot-password"&&e.jsx(z,{})]})}export{Z as default};
